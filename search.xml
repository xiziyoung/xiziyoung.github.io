<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[mysqlÂπªËØª]]></title>
    <url>%2F2019%2F07%2F05%2Fmysql%E5%B9%BB%E8%AF%BB%2F</url>
    <content type="text"><![CDATA[‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´mysql ÊúâÂõõÁ∫ß‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´: (ÂõæÊù•Ëá™: &lt;È´òÊÄßËÉΩmysql‰∏Ä‰π¶&gt;) Ëß£Èáä: ËÑèËØª: Âú®‰∫ãÂä°T1‰∏≠ÂèØ‰ª•ËØªÂèñÂà∞‰∫ãÂä°T2‰∏≠ËøòÊ≤°Êèê‰∫§ÁöÑÊõ¥Êñ∞; ‰∏çÂèØÈáçÂ§çËØª: ‰∫ãÂä°T1ËÉΩÂ§üËØªÂèñÂà∞‰∫ãÂä°T2Êèê‰∫§ÂêéÁöÑÊõ¥Êñ∞, ËøôÂ∞ÜÂØºËá¥‰∫ãÂä°T1Âú®T2Êèê‰∫§ÂâçÂêéËØªÂèñÂà∞ÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄÊ†∑, Âç≥‰∏çÂèØÈáçÂ§çËØª; ÂπªËØª: ÂπªËØªÔºåÂπ∂‰∏çÊòØÊåáÂú®Âêå‰∏Ä‰∫ãÂä°‰∏≠ÊâßË°å‰∏§Ê¨°ÂêåÊ†∑ÁöÑsqlËØ≠Âè•Ëé∑ÂèñÂà∞ÁöÑÁªìÊûúÈõÜ‰∏çÂêåÔºåÂπªËØª‰æßÈáçÁöÑÊñπÈù¢ÊòØÊüê‰∏ÄÊ¨°ÁöÑ select Êìç‰ΩúÂæóÂà∞ÁöÑÁªìÊûúÊâÄË°®ÂæÅÁöÑÊï∞ÊçÆÁä∂ÊÄÅÊó†Ê≥ïÊîØÊíëÂêéÁª≠ÁöÑ‰∏öÂä°Êìç‰Ωú„ÄÇÊõ¥‰∏∫ÂÖ∑‰Ωì‰∏Ä‰∫õÔºöselect ÊüêËÆ∞ÂΩïÊòØÂê¶Â≠òÂú®Ôºå‰∏çÂ≠òÂú®ÔºåÂáÜÂ§áÊèíÂÖ•Ê≠§ËÆ∞ÂΩïÔºå‰ΩÜÊâßË°å insert Êó∂ÂèëÁé∞Ê≠§ËÆ∞ÂΩïÂ∑≤Â≠òÂú®ÔºåÊó†Ê≥ïÊèíÂÖ•ÔºåÊ≠§Êó∂Â∞±ÂèëÁîü‰∫ÜÂπªËØª„ÄÇ ÂπªËØª‰∏æ‰æã: 1.ÂπªËØªÁöÑ‰∫ßÁîü:‰∏ãÈù¢Áî®REPEATABLE-READÈöîÁ¶ªÁ∫ßÂà´‰∏æ‰æãËØ¥Êòé Êü•ÁúãÁúã‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´ÂíåÊµãËØïË°®(innodbÂ≠òÂÇ®ÂºïÊìéÁöÑË°®)ÁªìÊûÑ: 12345678910111213141516171819202122232425262728293031mysql&gt; select @@global.tx_isolation, @@tx_isolation;+-----------------------+-----------------+| @@global.tx_isolation | @@tx_isolation |+-----------------------+-----------------+| REPEATABLE-READ | REPEATABLE-READ |+-----------------------+-----------------+1 row in setmysql&gt; mysql&gt; desc test;+-------+--------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+-------+--------------+------+-----+---------+----------------+| id | int(11) | NO | PRI | NULL | auto_increment || name | varchar(255) | NO | | NULL | |+-------+--------------+------+-----+---------+----------------+2 rows in set (1). ‰∫ãÂä°T1‰∏≠123456789mysql&gt; begin;Query OK, 0 rows affectedmysql&gt; select * from test where id =1;Empty setmysql&gt; (2). ‰∫ãÂä°T2:1234567891011121314151617181920212223242526272829mysql&gt; begin;Query OK, 0 rows affectedmysql&gt; select * from test where id =1;Empty setmysql&gt; insert into test values (1, &apos;first&apos;);Query OK, 1 row affectedmysql&gt; commit;Query OK, 0 rows affectedmysql&gt; select * from test where id =1;+----+-------+| id | name |+----+-------+| 1 | first |+----+-------+1 row in set (3). ÂõûÂà∞‰∫ãÂä°T1‰∏≠:12345678910111213mysql&gt; select * from test where id =1;Empty setmysql&gt; insert into test values(1, &apos;second&apos;);1062 - Duplicate entry &apos;1&apos; for key &apos;PRIMARY&apos;mysql&gt; mysql&gt; select * from test where id =1;Empty set Êàë‰ª¨ÂèØ‰ª•ÁúãÂà∞Âú®T2‰∫ãÂä°ÁöÑ‰∏≠ÈÄîÂπ≤Êâ∞‰∏ã, ÂØºËá¥T1‰∫ãÂä°Âá∫Áé∞‰∫ÜÂπªËØª : Âú®‰∫ãÂä°T1‰∏≠Êü•ËØ¢ id=1ÁöÑÊï∞ÊçÆ‰∏çÂ≠òÂú®, ‰ΩÜÊåáÂÆöid‰∏∫1ÊèíÂÖ•Êï∞ÊçÆÊó∂Âèà‰ºöÊäõÂá∫ÈîôËØØ Duplicate entry ‚Äò1‚Äô for key ‚ÄòPRIMARY‚Äô , ÁÑ∂ÂêéÊàë‰ª¨Âú®Âá∫Áé∞ÊèíÂÖ•ÈîôËØØÊèêÁ§∫Âêé, Âú®T1‰∏≠Êü•ËØ¢id=1ÁöÑÊï∞ÊçÆËøòÊòØ‰∏çÂ≠òÂú®„ÄÇ 2.SERIALIZABLEÈò≤Ê≠¢ÂπªËØªÁöÑÊñπÂºèÂõ†‰∏∫Âú®ËØ•ÈöîÁ¶ªÁ∫ßÂà´‰∏ã, ‰ºöÁªôËØªÂèñÂà∞ÁöÑÊØè‰∏ÄÊù°Êï∞ÊçÆÂº∫Âà∂Âä†ÈîÅ (Êï∞ÊçÆË°åÂ≠òÂú®Âä† XÈîÅ, ‰∏çÂ≠òÂú®ÁöÑÂä†Gap LockÈîÅ ), Âç≥ËÆ∞ÂΩïÂ≠òÂú®‰∏éÂê¶Ôºåmysql ÈÉΩ‰ºöÂØπËÆ∞ÂΩïÂ∫îËØ•ÂØπÂ∫îÁöÑÁ¥¢ÂºïÂä†ÈîÅÔºåÂÖ∂‰ªñ‰∫ãÂä°ÊòØÊó†Ê≥ïÂÜçËé∑ÂæóÂÅöÊìç‰ΩúÁöÑ„ÄÇ MySQL InnoDBÊîØÊåÅ‰∏âÁßçË°åÈîÅÂÆöÊñπÂºèÔºö Ë°åÈîÅÔºàRecord LockÔºâ:ÈîÅÁõ¥Êé•Âä†Âú®Á¥¢ÂºïËÆ∞ÂΩï‰∏äÈù¢ÔºåÈîÅ‰ΩèÁöÑÊòØkey„ÄÇ Èó¥ÈöôÈîÅÔºàGap LockÔºâ:ÈîÅÂÆöÁ¥¢ÂºïËÆ∞ÂΩïÈó¥ÈöôÔºåÁ°Æ‰øùÁ¥¢ÂºïËÆ∞ÂΩïÁöÑÈó¥Èöô‰∏çÂèò„ÄÇÈó¥ÈöôÈîÅÊòØÈíàÂØπ‰∫ãÂä°ÈöîÁ¶ªÁ∫ßÂà´‰∏∫ÂèØÈáçÂ§çËØªÊàñ‰ª•‰∏äÁ∫ßÂà´ËÄåÂ∑≤ÁöÑ„ÄÇ Next-Key Lock ÔºöË°åÈîÅÂíåÈó¥ÈöôÈîÅÁªÑÂêàËµ∑Êù•Â∞±Âè´Next-Key Lock„ÄÇ]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[test blog]]></title>
    <url>%2F2019%2F07%2F04%2Ftest-blog%2F</url>
    <content type="text"><![CDATA[Welcome to GitHub PagesYou can use the editor on GitHub to maintain and preview the content for your website in Markdown files. Whenever you commit to this repository, GitHub Pages will run Jekyll to rebuild the pages in your site, from the content in your Markdown files. MarkdownMarkdown is a lightweight and easy-to-use syntax for styling your writing. It includes conventions for 123456789101112131415Syntax highlighted code block# Header 1## Header 2### Header 3- Bulleted- List1. Numbered2. List**Bold** and _Italic_ and `Code` text[Link](url) and ![Image](src) For more details see GitHub Flavored Markdown. Jekyll ThemesYour Pages site will use the layout and styles from the Jekyll theme you have selected in your repository settings. The name of this theme is saved in the Jekyll _config.yml configuration file. Support or ContactHaving trouble with Pages? Check out our documentation or contact support and we‚Äôll help you sort it out.]]></content>
      <categories>
        <category>github</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysqlÊ≠ªÈîÅ]]></title>
    <url>%2F2018%2F07%2F06%2Fmysql%E6%AD%BB%E9%94%81%2F</url>
    <content type="text"><![CDATA[mysql‰∏≠ÁöÑÈîÅ:Âú®MySQL‰∏≠ÁöÑÈîÅÂàÜ‰∏§Â§ßÁ±ªÔºå‰∏ÄÁßçÊòØËØªÈîÅÔºå‰∏ÄÁßçÊòØÂÜôÈîÅÔºåËØªÈîÅÔºàread lockÔºâ‰πüÂèØ‰ª•Áß∞‰∏∫ÂÖ±‰∫´ÈîÅÔºàshared lockÔºâÔºåÂÜôÈîÅÔºàwrite lockÔºâ‰πüÈÄöÂ∏∏Áß∞‰∏∫ÊéíÂÆÉÈîÅÔºàexclusive lockÔºâ„ÄÇ ËØªÈîÅÊòØÂÖ±‰∫´ÁöÑÔºåÊàñËÄÖËØ¥ÊòØÁõ∏‰∫í‰∏çÈòªÂ°ûÁöÑ„ÄÇÂ§ö‰∏™ÂÆ¢Êà∑Âú®Âêå‰∏ÄÊó∂ÂàªÂèØ‰ª•ÂêåÊó∂ËØªÂèñ‰∏Ä‰∏™ËµÑÊ∫êÔºå‰∏î‰∫í‰∏çÂπ≤Êâ∞„ÄÇÂÜôÈîÅÂàôÊòØÊéí‰ªñÁöÑÔºåÂ∞±ÊòØËØ¥‰∏Ä‰∏™ÂÜôÈîÅ‰ºöÈòªÂ°ûÂÖ∂‰ªñÁöÑÂÜôÈîÅÂíåËØªÈîÅÔºåËøôÊòØÂá∫‰∫éÂÆâÂÖ®Á≠ñÁï•ÁöÑËÄÉËôëÔºåÂè™ÊúâËøôÊ†∑ÔºåÊâçËÉΩÁ°Æ‰øùÂú®ÁªôÂÆöÊó∂Èó¥ÈáåÔºåÂè™Êúâ‰∏Ä‰∏™Áî®Êà∑ËÉΩÊâßË°åÂÜôÂÖ•ÔºåÂπ∂Èò≤Ê≠¢ÂÖ∂‰ªñÁî®Êà∑ËØªÂèñÊ≠£Âú®ÂÜôÂÖ•ÁöÑÂêå‰∏ÄËµÑÊ∫ê„ÄÇ (ÂæÖË°•ÂÖÖ: ÈîÅÂäõÂ∫¶,Ë°åÈîÅ,Èó¥ÈöôÈîÅÁ≠â) Ê≠ªÈîÅ: Ê≠ªÈîÅÊ®°ÊãüË°®ÁªìÊûÑ: 12345CREATE TABLE `test` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8; ‰∫ãÂä°‰∏ÄT1‰∏≠: 12345678mysql&gt; START TRANSACTION;Query OK, 0 rows affectedmysql&gt; update `test` set `name`="T1" where `id`=1;Query OK, 1 row affectedRows matched: 1 Changed: 1 Warnings: 0mysql&gt; ‚Äã ‰∫ãÂä°‰∫åT2‰∏≠: Êñ∞ÁöÑ‰∫ãÂä°T2 12345678mysql&gt; START TRANSACTION;Query OK, 0 rows affectedmysql&gt; update `test` set `name`="T1" where `id`=3;Query OK, 1 row affectedRows matched: 1 Changed: 1 Warnings: 0mysql&gt; ‰∫ãÂä°T1: ‰∫ãÂä°T1‰πüÊâßË°åÂà†Èô§Êìç‰Ωú 12mysql&gt; update `test` set `name`=&quot;T1&quot; where `id`=3;---ÈòªÂ°ûÁ≠âÂæÖ‰∏≠,Á≠âÂæÖT2ÈáäÊîæid=3ËÆ∞ÂΩïÁöÑXÈîÅ ‰∫ãÂä°T2 123mysql&gt; update `test` set `name`=&quot;T2&quot; where `id`=1;1213 - Deadlock found when trying to get lock; try restarting transactionmysql&gt; ‰∫ãÂä°T2ÊäõÈîô, ‰∫ãÂä°T1ÁªßÁª≠ÊâßË°å: 123456mysql&gt; update `test` set `name`="T1" where `id`=3;Query OK, 1 row affectedRows matched: 1 Changed: 1 Warnings: 0mysql&gt; mysql&gt; commit;Query OK, 0 rows affected ÂèëÁîüÊ≠ªÈîÅÂêéÔºåInnoDB‰ºö‰∏∫ÂØπ‰∏Ä‰∏™ÂÆ¢Êà∑(Ê≠§Â§Ñ‰∏∫ ‰∫ãÂä°T2)‰∫ßÁîüÈîôËØØ‰ø°ÊÅØÂπ∂ÈáäÊîæÈîÅ„ÄÇËøîÂõûÁªôÂÆ¢Êà∑ÁöÑ‰ø°ÊÅØÔºö 12Deadlock found when trying to get lock;try restarting transaction ÊâÄ‰ª•ÔºåÂè¶‰∏Ä‰∏™ÂÆ¢Êà∑(‰∫ãÂä°T1)ÂèØ‰ª•Ê≠£Â∏∏ÊâßË°å‰ªªÂä°„ÄÇÊ≠ªÈîÅÁªìÊùü„ÄÇ Êó•Â∏∏Ê≥®ÊÑè:‰∫ãÂä°Â∞ΩÈáèÁÆÄÂçïÂåñ: 123456789101112131415 //ÂêÑÁßçÂÖ∂‰ªñÂèØ‰ª•‰∏çÂú®‰∫ãÂä°‰∏≠ÊâßË°åÁöÑÊìç‰Ωú,Â∫îËØ•Âú®‰∫ãÂä°Â§ñÊâßË°å,‰æãÂ¶ÇÂÖ∂‰ªñÁöÑÊï∞ÊçÆËé∑Âèñ,Êï∞ÊçÆÂ§ÑÁêÜ,Êï∞ÊçÆÊ†ºÂºèË∞ÉÊï¥,ÂÖ∂‰ªñËÄóÊó∂Â§ÑÁêÜÁ≠âÁ≠â$this-&gt;beginTrans(); //Âú®‰∫ãÂä°ÂÜÖ, Â∞ΩÈáèÂè™ÈõÜ‰∏≠Â§ÑÁêÜ‰∫ãÂä°ËØ•Â§ÑÁêÜÁöÑsqlÈÉ®ÂàÜ try &#123; $this-&gt;update(); //Âõ†‰∏∫Âú®‰∫ãÂä°‰∏≠,Â§ÑÁêÜËøô‰∫õ,‰∫ãÂä°Â∞±‰ºöÁ≠âÂæÖËøô‰∫õÂ§ÑÁêÜÂÆå‰∫Ü,ÂÜçÊèê‰∫§ÊàñËÄÖÂõûÊªö,ÈÇ£Ê†∑‰∫ãÂä°ÂÜÖÁöÑÈîÅÂ∞±‰ºöÊåÇËµ∑Â§™‰πÖ, ÂÆπÊòìÂØºËá¥Ê≠ªÈîÅÈóÆÈ¢ò $this-&gt;delete(); $this-&gt;commit(); &#125; catch (Exception $e) &#123; $this-&gt;rollBack(); throw new MessageException('Êìç‰ΩúÂ§±Ë¥•', 0); &#125;]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mysql‰ΩøÁî®]]></title>
    <url>%2F2017%2F08%2F10%2Fmysql%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[1.Â§ö‰∏™ÂÄºÁöÑ IN ÂåπÈÖçËØ≠Ê≥ï: (Â≠óÊÆµ1, Â≠óÊÆµ2) IN ( (Â≠óÊÆµ1ÁöÑÁªìÊûú1, Â≠óÊÆµ2ÁöÑÁªìÊûú1), (Â≠óÊÆµ1ÁöÑÁªìÊûú2, Â≠óÊÆµ2ÁöÑÁªìÊûú2) )ËØ≠Ê≥ïÁ§∫‰æã: select * from table where (field1, field2) in ( (field1_value,field2_value) , (field1_value, field2_value), (field1_value, field2_value) );ÂÆåÊï¥‰∏æ‰æã: 123456789101112131415161718192021222324252627-- ------------------------------ Table structure for Employee-- ----------------------------DROP TABLE IF EXISTS `Employee`;CREATE TABLE `Employee` ( `Id` int(11) NOT NULL AUTO_INCREMENT, `Name` varchar(255) NOT NULL, `Salary` int(11) NOT NULL, `DepartmentId` int(11) NOT NULL, PRIMARY KEY (`Id`)) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8;-- ------------------------------ Records of Employee-- ----------------------------INSERT INTO `Employee` VALUES ('1', 'Joe', '70000', '1');INSERT INTO `Employee` VALUES ('2', 'Henry', '80000', '2');INSERT INTO `Employee` VALUES ('3', 'Sam', '60000', '2');INSERT INTO `Employee` VALUES ('4', 'Max', '90000', '1');INSERT INTO `Employee` VALUES ('5', 'Tom', '90000', '1');-- Êü•ËØ¢ËØ≠Âè•:SELECT `Name` , `Salary`, `DepartmentId` FROM `Employee` where (Salary,DepartmentId) in((90000,1), (80000,2));-- Á≠â‰ª∑‰∫é: SELECT `Name` , `Salary`, `DepartmentId` FROM `Employee` where (`DepartmentId`, `Salary`) in (SELECT `DepartmentId`,MAX(`Salary`) as Salary FROM `Employee` GROUP BY `DepartmentId`); 2.Â≠óÊÆµÂä†ÂØÜÂ∏∏ËßÅÁöÑ:SELECT MD5(‚Äò123‚Äô);SELECT SHA(‚Äò123‚Äô);SELECT PASSWORD(‚Äò123‚Äô);MD5()ÔºöËÆ°ÁÆóÂ≠óÁ¨¶‰∏≤ÁöÑMD5Ê†°È™åÂíåSHAÔºöËÆ°ÁÆóÂ≠óÁ¨¶‰∏≤ÁöÑSHAÊ†°È™åÂíåPASSWORD()ÔºöÂàõÂª∫‰∏Ä‰∏™ÁªèËøáÂä†ÂØÜÁöÑÂØÜÁ†ÅÂ≠óÁ¨¶‰∏≤ÔºåÈÄÇÂêà‰∫éÊèíÂÖ•Âà∞MySQLÁöÑÂÆâÂÖ®Á≥ªÁªü„ÄÇËØ•Âä†ÂØÜËøáÁ®ã‰∏çÂèØÈÄÜÔºåÂíåunixÂØÜÁ†ÅÂä†ÂØÜËøáÁ®ã‰ΩøÁî®‰∏çÂêåÁöÑÁÆóÊ≥ï„ÄÇ‰∏ªË¶ÅÁî®‰∫éMySQLÁöÑËÆ§ËØÅÁ≥ªÁªü„ÄÇÂä†ÂØÜÂáΩÊï∞ÈùûÂ∏∏‰πãÂ§ö,ÂÆòÁΩë:https://dev.mysql.com/doc/refman/8.0/en/encryption-functions.html 2.1 AES_ENCRYPT Âíå AES_DECRYPT (Êé®Ëçê)‰ΩøÁî®AESÁÆóÊ≥ïËß£ÂØÜ/Âä†ÂØÜÂÖ∂Âä†ÂØÜÁöÑÁªìÊûúÊúÄÂ•Ω‰ΩøÁî®blobÁ±ªÂûãÂ≠òÂÇ®;ËØ≠Ê≥ï: AES_ENCRYPT(‚ÄòË¶ÅÂä†ÂØÜÁöÑÂÄº‚Äô, ‚Äòtoken key‚Äô) AES_DECRYPT(‚ÄòË¢´Âä†ÂØÜÁöÑÂ≠óÊÆµ‚Äô, ‚Äòtoken key‚Äô) 123456789101112131415161718192021222324252627282930313233343536CREATE TABLE `encrypt` ( `id` int(11) NOT NULL AUTO_INCREMENT, `email` varchar(255) NOT NULL, `email_e` varbinary(255) DEFAULT NULL, `phone` varchar(255) NOT NULL, `phone_e` varbinary(255) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8;-- È¶ñÂÖàËÆæÁΩÆÁî®Êù•Âä†ÂØÜÁöÑkeyÂÄº, ËØ•ÂèòÈáèÂú®‰ª•‰∏ãËØ≠Âè•‰∏≠‰ΩøÁî®SET @key = 'D7DF5B64DF1181EF1D62D646A13AA860';-- (1)-- Ê∑ªÂä†ÂÆåÊï¥ÁöÑÊï∞ÊçÆ, email_eÂíåphone_e‰ΩøÁî®AES_ENCRYPT('value',key)Âä†ÂØÜINSERT INTO `encrypt` (id,email,email_e,phone,phone_e) VALUES (1,'123456@qq.com', AES_ENCRYPT('123456@qq.com', @key), '12345678901', AES_ENCRYPT('12345678901', @key));-- ‰ΩøÁî® AES_DECRYPT(field, key)Êù•Ëß£ÂØÜ,Êü•ËØ¢SELECT *,AES_DECRYPT(email_e, @key) as eamil_value,AES_DECRYPT(phone_e, @key) as phone_value FROM `encrypt` where id=1;-- Êü•ËØ¢ÁªìÊûú+----+---------------+----------------+-------------+----------------+---------------+-------------+| id | email | email_e | phone | phone_e | eamil_value | phone_value |+----+---------------+----------------+-------------+----------------+---------------+-------------+| 1 | 123456@qq.com | ÊÆ∞SÂ©ãÂ∏£??K%Êß† | 12345678901 | Ëë°Ë¥áÈüö[qK„Äã?x? | 123456@qq.com | 12345678901 |+----+---------------+----------------+-------------+----------------+---------------+-------------+-- (2)-- ‰Ω†ËøòÂèØ‰ª•ÂØπkeyÂÜçÊ¨°ÁöÑËΩ¨Âèò‰∏ÄÊ¨°, ‰æãÂ¶Ç‰ΩøÁî®UNHEX, Âç≥AES_ENCRYPT('value',UNHEX(key))Âä†ÂØÜINSERT INTO `encrypt` (id,email,phone) VALUES (2,'test@qq.com', '55555555555');UPDATE `encrypt` set `email_e`= AES_ENCRYPT(`email`, UNHEX(@key)),`phone_e`= AES_ENCRYPT(`phone`, UNHEX(@key)) WHERE id =2;-- ÂØπÂ∫îÁöÑÊü•ËØ¢SELECT *,AES_DECRYPT(email_e, UNHEX(@key)) as eamil_value,AES_DECRYPT(phone_e, UNHEX(@key)) as phone_value FROM `encrypt` where id=2;-- Êü•ËØ¢ÁªìÊûú+----+-------------+-----------------+-------------+----------------+-------------+-------------+| id | email | email_e | phone | phone_e | eamil_value | phone_value |+----+-------------+-----------------+-------------+----------------+-------------+-------------+| 2 | test@qq.com | OËó¨ËïüL2ÁàΩ?È∑´? | 55555555555 | ÁßëeV3X6?ÊÅ¢ssÁ≥â | test@qq.com | 55555555555 |+----+-------------+-----------------+-------------+----------------+-------------+-------------+ Ê≥®ÊÑè: php ÁöÑcomposerÂ∫ì phpseclib/phpseclib ÂèØ‰ª•Áî®Êù•Â§ÑÁêÜPKCSÔºÉ1Ôºàv2.1ÔºâRSAÔºåDESÔºå3DESÔºåRC4ÔºåRijndaelÔºåAESÔºåBlowfishÔºåTwofishÔºåSSH-1ÔºåSSH-2Ôºå SFTPÂíåX.509ÊïÖmysqlÁöÑAES_ENCRYPTÂèØ‰ª•ÂíåphpÁöÑËøô‰∏™Â∫ìÁªìÂêà‰ΩøÁî® 2.2 ENCODE() Âíå DECODE()ENCODE(‚ÄòÈúÄË¶ÅÁºñÁ†ÅÂ≠óÁ¨¶‰∏≤‚Äô, ‚Äòtoken key‚Äô)DECODE(‚ÄòË¢´ÁºñÁ†ÅÁöÑÂ≠óÊÆµ‚Äô, ‚Äòtoken key‚Äô)ËØ•ÂáΩÊï∞Êúâ‰∏§‰∏™ÂèÇÊï∞ÔºöË¢´Âä†ÂØÜÊàñËß£ÂØÜÁöÑÂ≠óÁ¨¶‰∏≤Âíå‰Ωú‰∏∫Âä†ÂØÜÊàñËß£ÂØÜÂü∫Á°ÄÁöÑÂØÜÈí•„ÄÇEncodeÁªìÊûúÊòØ‰∏Ä‰∏™‰∫åËøõÂà∂Â≠óÁ¨¶‰∏≤Ôºå‰ª•BLOBÁ±ªÂûãÂ≠òÂÇ®„ÄÇÂä†ÂØÜÁ®ãÂ∫¶Áõ∏ÂØπÊØîËæÉÂº± 123456-- Ë°®ÁªìÊûÑÂêå‰∏äSET @key = 'D7DF5B64DF1181EF1D62D646A13AA860';INSERT INTO `encrypt` (id,email,email_e,phone,phone_e) VALUES (5,'new@qq.com', ENCODE('new@qq.com', @key), '000000', ENCODE('000000', @key));SELECT *,DECODE(email_e, @key) as eamil_value,DECODE(phone_e, @key) as phone_value FROM `encrypt` where id=5; 3.case whenÁöÑ‰ΩøÁî®3.1 case when Áî®‰∫éÊü•ËØ¢:ËøôÈáå‰ªãÁªç‰∏âÁßç‰ΩøÁî®ÊñπÊ≥ï: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879-- ------------------------------ Table structure for user-- ----------------------------DROP TABLE IF EXISTS `user`;CREATE TABLE `user` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) NOT NULL, `gender` tinyint(4) NOT NULL DEFAULT '1' COMMENT '1‰ª£Ë°®Áî∑,2‰ª£Ë°®Â•≥', `age` tinyint(4) NOT NULL, `country` varchar(255) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;-- ------------------------------ Records of user-- ----------------------------INSERT INTO `user` VALUES ('1', 'Â∞èÊòé', '1', '20', '‰∏≠ÂõΩ');INSERT INTO `user` VALUES ('2', 'Tom', '1', '18', 'USA');INSERT INTO `user` VALUES ('3', 'Sam', '2', '50', 'USA');INSERT INTO `user` VALUES ('4', 'Â∞èÂçé', '2', '22', '‰∏≠ÂõΩ');INSERT INTO `user` VALUES ('5', 'ËÄÅÂº†', '1', '70', '‰∏≠ÂõΩ');INSERT INTO `user` VALUES ('6', 'Joe', '1', '75', 'USA');-- (1). CASE Â≠óÊÆµ1 WHEN ÂÖ∑‰ΩìÁöÑÂÄº(‰∏çÂèØ‰∏∫Êüê‰∏™ËåÉÂõ¥ÂåπÈÖç) THEN 'value' ELSE 'valus' AS Â≠óÊÆµÂà´Âêç,-- CASE Â≠óÊÆµ2 WHEN ÂÖ∑‰ΩìÁöÑÂÄº THEN 'value' ELSE 'value' AS Â≠óÊÆµÂà´Âêç,SELECT *,CASE `country` WHEN '‰∏≠ÂõΩ' THEN 'ÈæôÁöÑ‰º†ÂÖ•' ELSE 'Â§ñÂõΩ‰∫∫' END AS 'ËÉåÊôØ',CASE `gender` WHEN '1' THEN 'Áî∑' ELSE 'Â•≥' END AS 'ÊÄßÂà´'FROM `user`;-- query result:+----+------+--------+-----+---------+----------+------+| id | name | gender | age | country | ËÉåÊôØ | ÊÄßÂà´ |+----+------+--------+-----+---------+----------+------+| 1 | Â∞èÊòé | 1 | 20 | ‰∏≠ÂõΩ | ÈæôÁöÑ‰º†ÂÖ• | Áî∑ || 2 | Tom | 1 | 18 | USA | Â§ñÂõΩ‰∫∫ | Áî∑ || 3 | Sam | 2 | 50 | USA | Â§ñÂõΩ‰∫∫ | Â•≥ || 4 | Â∞èÂçé | 2 | 22 | ‰∏≠ÂõΩ | ÈæôÁöÑ‰º†ÂÖ• | Â•≥ || 5 | ËÄÅÂº† | 1 | 70 | ‰∏≠ÂõΩ | ÈæôÁöÑ‰º†ÂÖ• | Áî∑ || 6 | Joe | 1 | 75 | USA | Â§ñÂõΩ‰∫∫ | Áî∑ |+----+------+--------+-----+---------+----------+------+-- (2).CASE WHEN Âçï‰∏™Â≠óÊÆµ Ëøô‰∏™ÂèØ‰ª•ÂØπÂ≠óÊÆµËøõË°åÂèñËåÉÂõ¥,‰πüÂèØÂÖ∑‰ΩìÂÄºSELECT *, CASE WHEN `age` &lt; 30 THEN 'ÈùíÂπ¥'WHEN `age` BETWEEN 30 and 50 THEN '‰∏≠Âπ¥' WHEN `age` = 70 THEN 'Âè§Á®Ä' ELSE 'ËÄÅÂπ¥' END AS 'Âπ¥ÈæÑ'FROM `user`;-- query result:+----+------+--------+-----+---------+------+| id | name | gender | age | country | Âπ¥ÈæÑ |+----+------+--------+-----+---------+------+| 1 | Â∞èÊòé | 1 | 20 | ‰∏≠ÂõΩ | ÈùíÂπ¥ || 2 | Tom | 1 | 18 | USA | ÈùíÂπ¥ || 3 | Sam | 2 | 50 | USA | ‰∏≠Âπ¥ || 4 | Â∞èÂçé | 2 | 22 | ‰∏≠ÂõΩ | ÈùíÂπ¥ || 5 | ËÄÅÂº† | 1 | 70 | ‰∏≠ÂõΩ | Âè§Á®Ä || 6 | Joe | 1 | 75 | USA | ËÄÅÂπ¥ |+----+------+--------+-----+---------+------+-- (3)CASE WHEN Â≠óÊÆµ1,Â≠óÊÆµ2ÔºåÂèØ‰ª•ÂØπÂ§ö‰∏™Â≠óÊÆµËøõË°åÊõøÊç¢SELECT *, CASE WHEN `age` &lt; 30 THEN 'ÈùíÂπ¥'WHEN `country` = '‰∏≠ÂõΩ' THEN 'ÈæôÁöÑ‰º†ÂÖ•' ELSE 'Êú™Áü•' END AS 'Â§áÊ≥®'FROM `user`;-- query result:+----+------+--------+-----+---------+----------+| id | name | gender | age | country | Â§áÊ≥® |+----+------+--------+-----+---------+----------+| 1 | Â∞èÊòé | 1 | 20 | ‰∏≠ÂõΩ | ÈùíÂπ¥ || 2 | Tom | 1 | 18 | USA | ÈùíÂπ¥ || 3 | Sam | 2 | 50 | USA | Êú™Áü• || 4 | Â∞èÂçé | 2 | 22 | ‰∏≠ÂõΩ | ÈùíÂπ¥ || 5 | ËÄÅÂº† | 1 | 70 | ‰∏≠ÂõΩ | ÈæôÁöÑ‰º†ÂÖ• || 6 | Joe | 1 | 75 | USA | Êú™Áü• |+----+------+--------+-----+---------+----------+ 3.2 case when Áî®‰∫éÊõ¥Êñ∞:12345678910111213141516171819202122232425-- (1).Âçï‰∏™Â≠óÊÆµÁöÑÊõ¥Êñ∞Á§∫‰æã:UPDATE `categories` SET `display_order` = CASE `id` WHEN 1 THEN 3 WHEN 2 THEN 4 WHEN 3 THEN 5 ELSE 0 ENDWHERE `id` IN (1,2,3)-- (2).Â§ö‰∏™Â≠óÊÆµÁöÑÊõ¥Êñ∞Á§∫‰æã:UPDATE `categories` SET `author` = 'Â∞èÊòé', `update_time` = '2017-10-10', `display_order` = CASE `id` WHEN 1 THEN 3 WHEN 2 THEN 4 WHEN 3 THEN 5 ELSE 0 END, `title` = CASE `id` WHEN 1 THEN 'New Title 1' WHEN 2 THEN 'New Title 2' WHEN 3 THEN 'New Title 3' ELSE 'null' ENDWHERE `id` IN (1,2,3) ÊèêÈÜí: Âú®‰ΩøÁî®ÊâπÈáèÊõ¥Êñ∞, ÊâπÈáèÊèíÂÖ•Á≠âÊñπÂºèÁöÑÊó∂ÂÄô, ÈúÄË¶ÅÊ≥®ÊÑèÊúÄÁªàÊâßË°åÁöÑsqlËØ≠Âè•ÁöÑÈïøÂ∫¶, ‰∏ÄËà¨sqlËØ≠Âè•ÁöÑÈïøÂ∫¶ÈªòËÆ§ÊúÄÂ§ß 1M , ÂèØÈÄöËøámysqlÈÖçÁΩÆÊñá‰ª∂my.ini‰øÆÊîπ max_allowed_packet(‰∏çÊé®Ëçê);Âª∫ËÆÆ: Âú®ÊâπÈáèÊèíÂÖ•/Êõ¥Êñ∞Êó∂, Ëã•ÊãÖÂøÉËØ≠Âè•ËøáÁ®ã, ÂèØ‰ª•Â∞ÜË¶ÅÊ∑ªÂä†ÊàñËÄÖÊõ¥Êñ∞ÁöÑÊï∞ÊçÆ ÂàÜÊàê Â§ö‰∏™ÊâπÊ¨°ÊâßË°å; ‰æãÂ¶ÇÊèíÂÖ•10000Êù°Êï∞ÊçÆ, ÂèØ‰ª•ÊØèÊ¨°ÊèíÂÖ•2000Êù°, ÂàÜ‰∫îÊ¨°ÊâßË°å; 4.ÁªôÊü•ËØ¢ÁªìÊûúÂ¢ûÂä†ÈÄíÂ¢ûÁöÑÂ∫èÂè∑ÂàóËØ≠Ê≥ï:select (@rowNO := @rowNo+1) AS rowno,ÂÖ∂‰ªñÂ≠óÊÆµ from (select @rowNO:=0) as temp, Êü•ËØ¢ÁöÑË°®‚Ä¶. 4.1 Á§∫‰æã:123456789101112131415161718192021222324252627-- ------------------------------ Table structure for Scores-- ----------------------------DROP TABLE IF EXISTS `Scores`;CREATE TABLE `Scores` ( `Id` int(11) NOT NULL AUTO_INCREMENT, `Score` float(5,2) NOT NULL, PRIMARY KEY (`Id`)) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8;-- ------------------------------ Records of Scores-- ----------------------------INSERT INTO `Scores` VALUES ('1', '3.50');INSERT INTO `Scores` VALUES ('2', '3.65');INSERT INTO `Scores` VALUES ('3', '4.00');INSERT INTO `Scores` VALUES ('4', '3.85');INSERT INTO `Scores` VALUES ('5', '4.00');INSERT INTO `Scores` VALUES ('6', '3.65');-- Êü•ËØ¢select (@rowNO := @rowNo+1) AS rowno,Score from (select @rowNO:=0) as temp, `Scores` ORDER BY Score desc;-- group byÁöÑËá™Â¢ûÂ∫èÂè∑-- ÈîôËØØ:select (@rowNO := @rowNo+1) AS rowno,Score from (select @rowNO:=0) as temp, `Scores` GROUP BY Score ORDER BY Score desc;-- Ê≠£Á°Æ:select (@rowNO := @rowNo+1) AS rowno,s.Score from (select @rowNO:=0) as temp, (SELECT * from `Scores` GROUP BY Score ORDER BY Score desc) as s; 4.2 leetcodeÁöÑ‰∏Ä‰∏™È¢ò:ÁºñÂÜô‰∏Ä‰∏™ SQL Êü•ËØ¢Êù•ÂÆûÁé∞ÂàÜÊï∞ÊéíÂêç„ÄÇÂ¶ÇÊûú‰∏§‰∏™ÂàÜÊï∞Áõ∏ÂêåÔºåÂàô‰∏§‰∏™ÂàÜÊï∞ÊéíÂêçÔºàRankÔºâÁõ∏Âêå„ÄÇËØ∑Ê≥®ÊÑèÔºåÂπ≥ÂàÜÂêéÁöÑ‰∏ã‰∏Ä‰∏™ÂêçÊ¨°Â∫îËØ•ÊòØ‰∏ã‰∏Ä‰∏™ËøûÁª≠ÁöÑÊï¥Êï∞ÂÄº„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÂêçÊ¨°‰πãÈó¥‰∏çÂ∫îËØ•Êúâ‚ÄúÈó¥Èöî‚Äù„ÄÇ +‚Äî-+‚Äî‚Äî-+| Id | Score |+‚Äî-+‚Äî‚Äî-+| 1 | 3.50 || 2 | 3.65 || 3 | 4.00 || 4 | 3.85 || 5 | 4.00 || 6 | 3.65 |+‚Äî-+‚Äî‚Äî-+‰æãÂ¶ÇÔºåÊ†πÊçÆ‰∏äËø∞ÁªôÂÆöÁöÑ Scores Ë°®Ôºå‰Ω†ÁöÑÊü•ËØ¢Â∫îËØ•ËøîÂõûÔºàÊåâÂàÜÊï∞‰ªéÈ´òÂà∞‰ΩéÊéíÂàóÔºâÔºö +‚Äî‚Äî-+‚Äî‚Äî+| Score | Rank |+‚Äî‚Äî-+‚Äî‚Äî+| 4.00 | 1 || 4.00 | 1 || 3.85 | 2 || 3.65 | 3 || 3.65 | 3 || 3.50 | 4 |+‚Äî‚Äî-+‚Äî‚Äî+ Êù•Ê∫êÔºöÂäõÊâ£ÔºàLeetCodeÔºâÈìæÊé•Ôºöhttps://leetcode-cn.com/problems/rank-scoresËëó‰ΩúÊùÉÂΩíÈ¢ÜÊâ£ÁΩëÁªúÊâÄÊúâ„ÄÇÂïÜ‰∏öËΩ¨ËΩΩËØ∑ËÅîÁ≥ªÂÆòÊñπÊéàÊùÉÔºåÈùûÂïÜ‰∏öËΩ¨ËΩΩËØ∑Ê≥®ÊòéÂá∫Â§Ñ„ÄÇ È¢òÁõÆÂàÜÊûê:ÂÖàgroup by order by ÊãøÂà∞ÂàÜÊï∞‰ªéÈ´òÂà∞Â∫ïÁöÑÊéíÂêç,Â¢ûÂä†ÊéíÂêçÂ∫èÂè∑; ÁÑ∂ÂêéÁî®ÂàÜÊï∞Ë°®left join ÊåâÁÖßÂàÜÊï∞È´ò‰ΩéÊéíÂêçÂç≥ÂèØ 1234567891011121314151617181920212223-- ------------------------------ Table structure for Scores-- ----------------------------DROP TABLE IF EXISTS `Scores`;CREATE TABLE `Scores` ( `Id` int(11) NOT NULL AUTO_INCREMENT, `Score` float(5,2) NOT NULL, PRIMARY KEY (`Id`)) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8;-- ------------------------------ Records of Scores-- ----------------------------INSERT INTO `Scores` VALUES ('1', '3.50');INSERT INTO `Scores` VALUES ('2', '3.65');INSERT INTO `Scores` VALUES ('3', '4.00');INSERT INTO `Scores` VALUES ('4', '3.85');INSERT INTO `Scores` VALUES ('5', '4.00');INSERT INTO `Scores` VALUES ('6', '3.65');-- ÊúÄÁªàÊü•ËØ¢ËØ≠Âè•:select m.`Score`,convert(r.rowno, UNSIGNED) as Rank from Scores as m LEFT JOIN (select (@rowNO:= @rowNo+1) AS rowno,s.Score from (SELECT * FROM `Scores` group by `Score` order by `Score` desc ) as s, (select @rowNO:=0) as temp) as r on m.`Score`=r.`Score` ORDER BY m.`Score` desc; 5.Á±ªÂûãËΩ¨Êç¢convert, È¶ñÂ≠óÁ¨¶ÊéíÂ∫è5.1.ËØ≠Ê≥ïËØ¥Êòé:MySQL ÁöÑCAST()ÂíåCONVERT()ÂáΩÊï∞ÂèØÁî®Êù•Ëé∑Âèñ‰∏Ä‰∏™Á±ªÂûãÁöÑÂÄºÔºåÂπ∂‰∫ßÁîüÂè¶‰∏Ä‰∏™Á±ªÂûãÁöÑÂÄº„ÄÇ‰∏§ËÄÖÂÖ∑‰ΩìÁöÑËØ≠Ê≥ïÂ¶Ç‰∏ãÔºöCAST(value as type);CONVERT(value, type);Âç≥: CAST(xxx AS Á±ªÂûã), CONVERT(xxx,Á±ªÂûã)„ÄÇ‰æãÂ¶Ç: SELECT CONVERT(‚Äò23.00‚Äô, SIGNED); ÂèØ‰ª•ËΩ¨Êç¢ÁöÑÁ±ªÂûãÊòØÊúâÈôêÂà∂ÁöÑ„ÄÇËøô‰∏™Á±ªÂûãÂèØ‰ª•ÊòØ‰ª•‰∏ãÂÄºÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™Ôºö‰∫åËøõÂà∂ÔºåÂêåÂ∏¶binaryÂâçÁºÄÁöÑÊïàÊûú : BINARYÂ≠óÁ¨¶ÂûãÔºåÂèØÂ∏¶ÂèÇÊï∞ : CHAR()Êó•Êúü : DATEÊó∂Èó¥: TIMEÊó•ÊúüÊó∂Èó¥Âûã : DATETIMEÊµÆÁÇπÊï∞ : DECIMALÊï¥Êï∞ : SIGNEDÊó†Á¨¶Âè∑Êï¥Êï∞ : UNSIGNED 5.2.‰ª•Ê±âÂ≠óÈ¶ñÂ≠óÁ¨¶ÊéíÂ∫ènameÂ≠óÊÆµÊåâÁÖßÊ±âÂ≠óÊ≠£Â∫è , ‰ª•nameÂºÄÂ§¥Á¨¨‰∏Ä‰∏™Â≠óÁ¨¶Êù•ÊéíÂ∫è,‰æùÊ¨°ÊòØÁ©∫Ê†º 0-9 a-z Â≠óÁ¨¶ ,Ê±âÂ≠óÈ¶ñÂ≠óÊãºÈü≥ÁöÑÈ¶ñÂ≠óÊØçÊåâÁÖßa-zÊù•ÊéíÂ∫è;select DISTINCT name from your_table order by convert(name using gbk) asc limit 300;]]></content>
      <categories>
        <category>Êï∞ÊçÆÂ∫ì</category>
      </categories>
      <tags>
        <tag>mysql</tag>
      </tags>
  </entry>
</search>
